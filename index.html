<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ìŠ¤ë„¤ì´í¬ ê²Œì„ (í•œ íŒŒì¼)</title>
  <style>
    :root {
      --bg: #0f1220;
      --panel: #171a2b;
      --accent: #6cf;
      --accent-2: #8aff80;
      --text: #e9ecf1;
      --grid: #232742;
      --snake: #56ffb0;
      --snake-head: #fff06c;
      --food: #ff6b6b;
      --danger: #ff3b3b;
      --shadow: 0 10px 30px rgba(0,0,0,.45);
      --radius: 14px;
    }

    * { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
      background: radial-gradient(1200px 600px at 30% -20%, #1a1f3b 0%, #0f1220 50%, #0c0f1a 100%) fixed;
      color: var(--text);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", Arial, sans-serif;
    }

    .container {
      max-width: 760px;
      margin: clamp(12px, 3.5vh, 28px) auto;
      padding: 18px clamp(12px, 2vw, 24px);
    }

    h1 {
      margin: 0 0 12px;
      font-size: clamp(22px, 2.6vw, 30px);
      letter-spacing: .3px;
      font-weight: 700;
      color: #f4f7ff;
      text-shadow: 0 2px 10px rgba(108, 204, 255, .25);
    }

    .hud {
      background: linear-gradient(180deg, #1a1f35 0%, #151a2c 100%);
      border: 1px solid #2b335d;
      box-shadow: var(--shadow), inset 0 1px 0 rgba(255,255,255,.04);
      padding: 12px;
      border-radius: var(--radius);
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items: center;
      margin-bottom: 14px;
    }

    .score {
      font-weight: 700;
      color: #e9efff;
    }
    .score span {
      color: var(--accent-2);
    }

    .controls {
      display: flex;
      align-items: center;
      gap: 8px 10px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    button, .chip {
      appearance: none;
      border: 1px solid #2a335c;
      background: linear-gradient(180deg, #2a3158 0%, #21284a 100%);
      color: #eaf2ff;
      padding: 8px 12px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      letter-spacing: .2px;
      transition: transform .03s ease, filter .15s ease, border-color .2s ease;
      box-shadow: 0 4px 16px rgba(0,0,0,.3), inset 0 1px 0 rgba(255,255,255,.05);
    }
    button:hover { filter: brightness(1.08); }
    button:active { transform: translateY(1px); }
    button:disabled {
      opacity: .55;
      cursor: not-allowed;
      filter: grayscale(.25);
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      background: linear-gradient(180deg, #243058 0%, #1b2447 100%);
      user-select: none;
    }

    .range {
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    input[type="range"] {
      accent-color: #6cf;
      height: 6px;
    }
    .label-muted { color: #a8b3d1; font-size: 13px; }

    .stage {
      position: relative;
      margin-inline: auto;
      width: min(92vw, 520px);
      aspect-ratio: 1 / 1;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: var(--shadow), 0 0 0 1px #2b335d;
      background:
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0)) padding-box,
        radial-gradient(800px 420px at 20% -10%, rgba(108,204,255,.08), rgba(108,204,255,0)) padding-box,
        #0f1220;
    }

    canvas#board {
      display: block;
      width: 100%;
      height: 100%;
      outline: none;
      border-radius: inherit;
      /* ê²©ì íš¨ê³¼ë¥¼ ë°°ê²½ìœ¼ë¡œ ë¯¸ë¦¬ ì¶”ê°€ */
      background-image:
        linear-gradient(0deg, transparent calc(100% - 1px), var(--grid) 1px),
        linear-gradient(90deg, transparent calc(100% - 1px), var(--grid) 1px);
      background-size: 24px 24px, 24px 24px;  /* JS CELL_SIZEì™€ ì¼ì¹˜ */
      image-rendering: crisp-edges;
      image-rendering: pixelated;
    }

    .overlay {
      position: absolute;
      inset: 0;
      display: grid;
      place-items: center;
      background: radial-gradient(600px 300px at 50% 30%, rgba(10,12,24,.65), rgba(10,12,24,.85));
      color: var(--text);
      text-align: center;
      padding: 18px;
      backdrop-filter: blur(1px);
    }
    .overlay.hidden { display: none; }
    .overlay-card {
      background: linear-gradient(180deg, #181d34 0%, #11162a 100%);
      border: 1px solid #2b335d;
      border-radius: 14px;
      padding: 18px 16px;
      max-width: 80%;
      box-shadow: var(--shadow);
    }
    .overlay h2 {
      margin: 0 0 8px; font-size: 22px; color: #f6f8ff;
      text-shadow: 0 1px 0 rgba(0,0,0,.4);
    }
    .overlay p { margin: 0 0 12px; color: #cfd7f2; }

    .hint {
      margin: 10px 2px 0;
      color: #97a3c7;
      font-size: 13px;
    }
    kbd {
      background: #1b2341;
      border: 1px solid #2a335c;
      border-bottom-color: #1a2142;
      padding: 2px 6px;
      border-radius: 6px;
      color: #e9efff;
      box-shadow: inset 0 -1px 0 rgba(0,0,0,.35);
      font-weight: 600;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <main class="container">
    <h1>ìŠ¤ë„¤ì´í¬ ê²Œì„</h1>

    <section class="hud" aria-label="ê²Œì„ ì •ë³´ì™€ ì»¨íŠ¸ë¡¤">
      <div class="score" aria-live="polite">ì ìˆ˜: <span id="score">0</span></div>
      <div class="controls">
        <button id="btn-start" type="button">ì‹œì‘</button>
        <button id="btn-pause" type="button" disabled>ì¼ì‹œì •ì§€</button>
        <button id="btn-restart" type="button" disabled>ì¬ì‹œì‘</button>
        <span class="chip range">
          <span class="label-muted">ì†ë„</span>
          <input id="speed" type="range" min="5" max="20" value="10" />
          <span id="speed-label" class="label-muted">10 fps</span>
        </span>
      </div>
    </section>

    <section class="stage">
      <canvas id="board" width="480" height="480" tabindex="0" aria-label="ìŠ¤ë„¤ì´í¬ ê²Œì„ ë³´ë“œ"></canvas>

      <div id="overlay" class="overlay">
        <div class="overlay-card">
          <h2>ìŠ¤í˜ì´ìŠ¤ë¥¼ ëˆŒëŸ¬ ì‹œì‘!</h2>
          <p>ë°©í–¥í‚¤ <kbd>â†‘</kbd> <kbd>â†“</kbd> <kbd>â†</kbd> <kbd>â†’</kbd> ë¡œ ì¡°ì‘í•©ë‹ˆë‹¤.</p>
          <p class="label-muted">ë˜ëŠ” ì•„ë˜ <b>ì‹œì‘</b> ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.</p>
          <div style="margin-top:10px; display:flex; gap:8px; justify-content:center;">
            <button id="overlay-start" type="button">ì‹œì‘</button>
          </div>
        </div>
      </div>
    </section>

    <p class="hint">
      ì¡°ì‘: <kbd>â†‘</kbd> <kbd>â†“</kbd> <kbd>â†</kbd> <kbd>â†’</kbd> &nbsp;Â·&nbsp; <kbd>Space</kbd>: ì¼ì‹œì •ì§€/ì¬ê°œ &nbsp;Â·&nbsp; <kbd>R</kbd>: ì¬ì‹œì‘
    </p>
  </main>

  <script>
    "use strict";

    // ====== ê¸°ë³¸ ì„¤ì • ======
    const CELL_SIZE = 24;              // ìº”ë²„ìŠ¤ ê·¸ë¦¬ë“œ ì…€ í¬ê¸°(px)
    const BOARD_PX = 480;             // ê¸°ë³¸ ë³´ë“œ í¬ê¸°(px) - CSSì—ì„œ ë°˜ì‘í˜•ìœ¼ë¡œ ìŠ¤ì¼€ì¼ë§
    const INITIAL_LENGTH = 4;         // ì‹œì‘ ë±€ ê¸¸ì´
    const INITIAL_FPS = 10;           // ì‹œì‘ í”„ë ˆì„(í‹±) ì†ë„
    const WALLS_KILL = true;          // true: ë²½ì— ë¶€ë”ªíˆë©´ ê²Œì„ì˜¤ë²„ / false: ë°˜ëŒ€í¸ìœ¼ë¡œ í†µê³¼(ì›Œí”„)

    // ====== DOM ======
    const canvas = document.getElementById("board");
    const scoreEl = document.getElementById("score");
    const btnStart = document.getElementById("btn-start");
    const btnPause = document.getElementById("btn-pause");
    const btnRestart = document.getElementById("btn-restart");
    const speedRange = document.getElementById("speed");
    const speedLabel = document.getElementById("speed-label");

    const overlay = document.getElementById("overlay");
    const overlayStart = document.getElementById("overlay-start");

    // ====== ìº”ë²„ìŠ¤ DPI ìŠ¤ì¼€ì¼ ì²˜ë¦¬ ======
    const ctx = (() => {
      const dpr = Math.max(1, Math.min(window.devicePixelRatio || 1, 2)); // ê³¼ë„í•œ ë°°ìœ¨ ë°©ì§€
      // ì‹¤ì œ í”½ì…€ í¬ê¸°ë¥¼ DPRë§Œí¼ ëŠ˜ë¦¬ê³ , ê·¸ë§Œí¼ scale
      canvas.width = BOARD_PX * dpr;
      canvas.height = BOARD_PX * dpr;
      canvas.style.width = "100%";     // CSSë¡œ ë°˜ì‘í˜•
      canvas.style.height = "100%";
      const c = canvas.getContext("2d");
      c.scale(dpr, dpr);
      return c;
    })();

    // ë³´ë“œ ì…€ ê³„ì‚° (ì •ì‚¬ê°í˜•)
    const COLS = Math.floor(BOARD_PX / CELL_SIZE);
    const ROWS = Math.floor(BOARD_PX / CELL_SIZE);

    // ====== ê²Œì„ ìƒíƒœ ======
    let snake = [];            // ê° ìš”ì†Œ: {x, y}
    let dir = { x: 1, y: 0 };  // í˜„ì¬ ì§„í–‰ ë°©í–¥
    let nextDir = { x: 1, y: 0 }; // ì…ë ¥ ë²„í¼(í‹± ì‚¬ì´ ì¤‘ë³µ ì…ë ¥ ì²˜ë¦¬)
    let food = { x: 10, y: 10 };
    let score = 0;

    // ë£¨í”„/ì‹œê°„
    let isRunning = false;
    let isPaused = false;
    let gameOver = false;
    let lastTime = 0;
    let step = 1000 / INITIAL_FPS;   // ms per tick
    let acc = 0;

    // ====== ìœ í‹¸ ======
    function randInt(n) { return Math.floor(Math.random() * n); }
    function equal(a, b) { return a.x === b.x && a.y === b.y; }

    function cellToPx(x, y) {
      return { px: x * CELL_SIZE, py: y * CELL_SIZE };
    }

    function setFPS(fps) {
      fps = Math.max(1, Math.min(60, fps));
      step = 1000 / fps;
      speedLabel.textContent = `${fps} fps`;
    }

    function resetGame() {
      score = 0;
      scoreEl.textContent = "0";
      dir = { x: 1, y: 0 };
      nextDir = { x: 1, y: 0 };
      gameOver = false;
      isPaused = false;

      // ë±€ ì´ˆê¸°í™” (ì¤‘ì•™ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ)
      const startX = Math.floor(COLS / 2) - Math.floor(INITIAL_LENGTH / 2);
      const y = Math.floor(ROWS / 2);
      snake = [];
      for (let i = 0; i < INITIAL_LENGTH; i++) {
        snake.push({ x: startX + i, y });
      }

      // ë¨¹ì´ ë°°ì¹˜
      placeFood();

      // HUD ë²„íŠ¼ ìƒíƒœ
      btnStart.disabled = true;
      btnPause.disabled = false;
      btnRestart.disabled = false;

      // ìº”ë²„ìŠ¤ í¬ì»¤ìŠ¤ (í‚¤ ì…ë ¥)
      canvas.focus();

      // ì• ë‹ˆë©”ì´ì…˜ ì´ˆê¸°í™”
      acc = 0;
      lastTime = performance.now();
    }

    function startGame() {
      if (isRunning) return;
      resetGame();
      isRunning = true;
      overlay.classList.add("hidden");
      requestAnimationFrame(loop);
    }

    function pauseGame(toggle = true) {
      if (!isRunning || gameOver) return;
      if (toggle) isPaused = !isPaused;
      if (!isPaused) {
        lastTime = performance.now(); // ì¬ê°œ ì‹œ ì‹œê°„ ë³´ì •
      }
      // UI ì—…ë°ì´íŠ¸
      btnPause.textContent = isPaused ? "ì¬ê°œ" : "ì¼ì‹œì •ì§€";
      draw(); // ì˜¤ë²„ë ˆì´ ì•ˆë‚´ë¥¼ ìº”ë²„ìŠ¤ ìœ„ì— ê·¸ë¦¬ê¸° ìœ„í•¨
    }

    function endGame(reason = "ê²Œì„ ì˜¤ë²„!") {
      gameOver = true;
      isRunning = false;
      isPaused = false;
      btnPause.disabled = true;
      btnStart.disabled = false;
      btnPause.textContent = "ì¼ì‹œì •ì§€";
      showOverlay(reason);
    }

    function showOverlay(title) {
      overlay.innerHTML = `
        <div class="overlay-card">
          <h2>${title}</h2>
          <p>ì ìˆ˜: <b style="color:var(--accent-2)">${score}</b></p>
          <p class="label-muted">ë‹¤ì‹œ í•˜ë ¤ë©´ <b>ì¬ì‹œì‘</b> ë˜ëŠ” <kbd>R</kbd>ì„ ëˆ„ë¥´ì„¸ìš”.</p>
          <div style="margin-top:10px; display:flex; gap:8px; justify-content:center;">
            <button id="overlay-restart" type="button">ì¬ì‹œì‘</button>
          </div>
        </div>
      `;
      overlay.classList.remove("hidden");
      document.getElementById("overlay-restart").onclick = () => {
        overlay.classList.add("hidden");
        startGame();
      };
    }

    // ====== ë¨¹ì´ ë°°ì¹˜ ======
    function placeFood() {
      // ë¹ˆ ì¹¸ ì¤‘ í•˜ë‚˜ë¥¼ ë¬´ì‘ìœ„ë¡œ ì„ íƒ
      const occupied = new Set(snake.map(s => s.x + "," + s.y));
      const empty = [];
      for (let y = 0; y < ROWS; y++) {
        for (let x = 0; x < COLS; x++) {
          const key = x + "," + y;
          if (!occupied.has(key)) empty.push({ x, y });
        }
      }
      if (empty.length === 0) {
        endGame("í´ë¦¬ì–´! í›Œë¥­í•´ìš” ğŸ‰");
        return;
      }
      food = empty[randInt(empty.length)];
    }

    // ====== ì¶©ëŒ ê²€ì‚¬ ======
    function hitWall(pos) {
      if (!WALLS_KILL) return false;
      return pos.x < 0 || pos.x >= COLS || pos.y < 0 || pos.y >= ROWS;
    }
    function wrap(pos) {
      // ë²½ í†µê³¼ ëª¨ë“œì¼ ë•Œ ì¢Œ/ìš°/ìƒ/í•˜ ì›Œí”„
      let { x, y } = pos;
      if (x < 0) x = COLS - 1;
      if (x >= COLS) x = 0;
      if (y < 0) y = ROWS - 1;
      if (y >= ROWS) y = 0;
      return { x, y };
    }
    function hitSelf(pos) {
      // ë¨¸ë¦¬ë¥¼ ì œì™¸í•œ ëª¸ì²´ ì¶©ëŒ
      for (let i = 0; i < snake.length; i++) {
        if (equal(snake[i], pos)) return true;
      }
      return false;
    }

    // ====== í‹±(ë¡œì§ ì—…ë°ì´íŠ¸) ======
    function update() {
      // ì…ë ¥ ë²„í¼ë¥¼ í˜„ì¬ ë°©í–¥ìœ¼ë¡œ ì ìš© (ë°˜ëŒ€ë°©í–¥ ì¦‰ì‹œì „í™˜ ë°©ì§€)
      if (
        (nextDir.x !== -dir.x || nextDir.y !== -dir.y) &&
        (nextDir.x !== dir.x || nextDir.y !== dir.y)
      ) {
        dir = { ...nextDir };
      }

      let head = snake[snake.length - 1];
      let newHead = { x: head.x + dir.x, y: head.y + dir.y };

      // ë²½ ì²˜ë¦¬
      if (WALLS_KILL) {
        if (hitWall(newHead)) {
          endGame("ë²½ì— ë¶€ë”ªí˜”ì–´ìš” ğŸ’¥");
          return;
        }
      } else {
        newHead = wrap(newHead);
      }

      // ìê¸° ëª¸ ì¶©ëŒ
      if (hitSelf(newHead)) {
        endGame("ëª¸í†µê³¼ ì¶©ëŒ! ğŸ’¥");
        return;
      }

      // ì´ë™
      snake.push(newHead);

      // ë¨¹ì´ ì²´í¬
      if (equal(newHead, food)) {
        score += 10;
        scoreEl.textContent = String(score);
        placeFood(); // ê¸¸ì´ ì¦ê°€(ê¼¬ë¦¬ ì œê±°í•˜ì§€ ì•ŠìŒ)
      } else {
        snake.shift(); // ê¸¸ì´ ìœ ì§€
      }
    }

    // ====== ë Œë”ë§ ======
    function drawGrid(ctx) {
      // ìº”ë²„ìŠ¤ ë°°ê²½ì— CSS ê·¸ë¦¬ë“œê°€ ìˆìœ¼ë¯€ë¡œ, ì¶”ê°€ì ì¸ ë³´ì¡°ì„ /í…Œë‘ë¦¬ë§Œ ê·¸ë¦½ë‹ˆë‹¤.
      ctx.save();
      ctx.strokeStyle = "rgba(255,255,255,.06)";
      ctx.lineWidth = 2;
      ctx.strokeRect(1, 1, BOARD_PX - 2, BOARD_PX - 2);
      ctx.restore();
    }

    function drawFood(ctx) {
      const { px, py } = cellToPx(food.x, food.y);
      const r = Math.floor(CELL_SIZE / 2) - 2;
      ctx.save();
      ctx.translate(px + CELL_SIZE / 2, py + CELL_SIZE / 2);
      // ê·¸ë¦¼ì
      ctx.shadowColor = "rgba(255, 107, 107, .4)";
      ctx.shadowBlur = 10;
      // ë³¸ì²´
      ctx.fillStyle = "#ff7575";
      ctx.beginPath();
      ctx.arc(0, 0, r, 0, Math.PI * 2);
      ctx.fill();
      // í•˜ì´ë¼ì´íŠ¸
      ctx.shadowBlur = 0;
      ctx.fillStyle = "rgba(255,255,255,.5)";
      ctx.beginPath();
      ctx.arc(-4, -4, r * 0.35, 0, Math.PI * 2);
      ctx.fill();
      ctx.restore();
    }

    function drawSnake(ctx) {
      ctx.save();
      // ëª¸í†µ
      for (let i = 0; i < snake.length - 1; i++) {
        const s = snake[i];
        const { px, py } = cellToPx(s.x, s.y);
        ctx.fillStyle = "#56ffb0";
        ctx.globalAlpha = 0.9;
        roundRect(ctx, px + 2, py + 2, CELL_SIZE - 4, CELL_SIZE - 4, 6);
        ctx.fill();
      }
      // ë¨¸ë¦¬
      const head = snake[snake.length - 1];
      const { px, py } = cellToPx(head.x, head.y);
      ctx.globalAlpha = 1;
      ctx.fillStyle = "#fff06c";
      roundRect(ctx, px + 2, py + 2, CELL_SIZE - 4, CELL_SIZE - 4, 8);
      ctx.fill();
      ctx.restore();
    }

    function roundRect(ctx, x, y, w, h, r) {
      ctx.beginPath();
      ctx.moveTo(x + r, y);
      ctx.arcTo(x + w, y, x + w, y + h, r);
      ctx.arcTo(x + w, y + h, x, y + h, r);
      ctx.arcTo(x, y + h, x, y, r);
      ctx.arcTo(x, y, x + w, y, r);
      ctx.closePath();
    }

    function drawHUD(ctx) {
      ctx.save();
      ctx.fillStyle = "rgba(0,0,0,.3)";
      ctx.fillRect(8, 8, 140, 28);
      ctx.fillStyle = "#dfe7ff";
      ctx.font = "bold 16px system-ui, -apple-system, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif";
      ctx.fillText(`ì ìˆ˜: ${score}`, 16, 28);
      ctx.restore();

      if (isPaused && !gameOver) {
        ctx.save();
        ctx.fillStyle = "rgba(15,18,32,.75)";
        ctx.fillRect(0, 0, BOARD_PX, BOARD_PX);
        ctx.fillStyle = "#eaf2ff";
        ctx.textAlign = "center";
        ctx.font = "bold 22px system-ui, -apple-system, 'Segoe UI', Roboto";
        ctx.fillText("ì¼ì‹œì •ì§€", BOARD_PX / 2, BOARD_PX / 2 - 8);
        ctx.font = "14px system-ui";
        ctx.fillStyle = "#b9c4e6";
        ctx.fillText("ìŠ¤í˜ì´ìŠ¤ë¡œ ì¬ê°œ", BOARD_PX / 2, BOARD_PX / 2 + 16);
        ctx.restore();
      }
    }

    function clearBoard(ctx) {
      // ë°°ê²½ ê·¸ë¼ë°ì´ì…˜
      const g = ctx.createLinearGradient(0, 0, 0, BOARD_PX);
      g.addColorStop(0, "#0f1326");
      g.addColorStop(1, "#0b0f1e");
      ctx.fillStyle = g;
      ctx.fillRect(0, 0, BOARD_PX, BOARD_PX);
    }

    function draw() {
      clearBoard(ctx);
      drawGrid(ctx);
      drawFood(ctx);
      drawSnake(ctx);
      drawHUD(ctx);
    }

    // ====== ë£¨í”„ ======
    function loop(t) {
      if (!isRunning) return;
      const dt = t - lastTime;
      lastTime = t;

      if (!isPaused) {
        acc += dt;
        while (acc >= step) {
          acc -= step;
          update();
          if (!isRunning || gameOver) break;
        }
      }

      draw();
      if (isRunning) requestAnimationFrame(loop);
    }

    // ====== ì…ë ¥ ì²˜ë¦¬ ======
    // ë°©í–¥í‚¤: ì¦‰ì‹œ ë°˜ì‘ + í˜ì´ì§€ ìŠ¤í¬ë¡¤ ë°©ì§€
    window.addEventListener("keydown", (e) => {
      const key = e.key;
      const isArrow = ["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight"].includes(key);
      if (isArrow || key === " " || key.toLowerCase() === "r") {
        e.preventDefault();
      }

      if (key === " "){ // Space
        if (!isRunning) {
          startGame();
        } else if (!gameOver) {
          pauseGame(true);
        }
        return;
      }

      if (key.toLowerCase() === "r"){
        // ì¬ì‹œì‘
        startGame();
        return;
      }

      // ë°©í–¥ ì „í™˜ (ë°˜ëŒ€ ë°©í–¥ ì¦‰ì‹œì „í™˜ ë°©ì§€)
      switch (key) {
        case "ArrowUp":
          if (dir.y !== 1) nextDir = { x: 0, y: -1 };
          break;
        case "ArrowDown":
          if (dir.y !== -1) nextDir = { x: 0, y: 1 };
          break;
        case "ArrowLeft":
          if (dir.x !== 1) nextDir = { x: -1, y: 0 };
          break;
        case "ArrowRight":
          if (dir.x !== -1) nextDir = { x: 1, y: 0 };
          break;
      }
    }, { passive: false });

    // ë²„íŠ¼ ì—°ê²°
    btnStart.addEventListener("click", startGame);
    btnPause.addEventListener("click", () => pauseGame(true));
    btnRestart.addEventListener("click", startGame);
    overlayStart.addEventListener("click", startGame);

    // ì†ë„ ì¡°ì ˆ
    speedRange.addEventListener("input", (e) => {
      const fps = parseInt(e.target.value, 10);
      setFPS(fps);
    });
    setFPS(INITIAL_FPS);

    // ì´ˆì  ì œì–´ (í´ë¦­ ì‹œ í‚¤ ì…ë ¥ ì˜ ë°›ë„ë¡)
    canvas.addEventListener("mousedown", () => canvas.focus());

    // ì´ˆê¸° ë Œë”(ëŒ€ê¸° í™”ë©´)
    draw();
  </script>
</body>
</html>
